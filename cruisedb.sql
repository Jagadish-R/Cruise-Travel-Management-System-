-- Cruise Management System --

CREATE TABLE CITY
(CNAME VARCHAR(15) NOT NULL,
STATE VARCHAR(15), 
COUNTRY VARCHAR(30),
PRIMARY KEY(CNAME));

SELECT *FROM CITY;




-- Insering values of Table: CITY--
INSERT INTO CITY (CNAME, STATE, COUNTRY) VALUES('Louisville','Kentucky','United States');
INSERT INTO CITY (CNAME, STATE, COUNTRY) VALUES ('Mumbai','Maharastra','India');
INSERT INTO CITY (CNAME, STATE, COUNTRY) VALUES ('Cochin','Kolkatta','India');
INSERT INTO CITY (CNAME, STATE, COUNTRY) VALUES('Naha','West japan','japan');
INSERT INTO CITY (CNAME, STATE, COUNTRY) VALUES('Mahahual','Mahal','Maxico');
INSERT INTO CITY (CNAME, STATE, COUNTRY) VALUES('San Francisco', 'California', 'United States');
INSERT INTO CITY (CNAME, STATE, COUNTRY) VALUES('Frankfurt','Hesse','Germany');
INSERT INTO CITY (CNAME, STATE, COUNTRY) VALUES('Houston','Texas','United States');
INSERT INTO CITY (CNAME, STATE, COUNTRY) VALUES('Mangalore','Karnataka','India');
INSERT INTO CITY (CNAME, STATE, COUNTRY) VALUES('Marmugao', 'Goa', 'India');


CREATE TABLE cruiseport
(CP_NAME VARCHAR(100) NOT NULL,
STATE VARCHAR(15), 
COUNTRY VARCHAR(30),
CNAME VARCHAR(15),
PRIMARY KEY(CP_NAME),
FOREIGN KEY(CNAME) REFERENCES CITY(CNAME) ON DELETE CASCADE);

--Insering values for Table: cruiseport--

INSERT INTO cruiseport (CP_NAME, STATE, COUNTRY, CNAME) VALUES('Port of Miami cruiseport','Kentucky','United States','Louisville');
INSERT INTO cruiseport (CP_NAME, STATE, COUNTRY, CNAME) VALUES('Port of Texas and NEW Jersey','Texas','United States','Houston');
INSERT INTO cruiseport (CP_NAME, STATE, COUNTRY, CNAME) VALUES('Dallas/Fort Worth . cruiseport','California','United States','San Francisco');
INSERT INTO cruiseport (CP_NAME, STATE, COUNTRY, CNAME) VALUES('Port of Venice','West japan','Japan','Naha');
INSERT INTO cruiseport (CP_NAME, STATE, COUNTRY, CNAME) VALUES('Port of Naha','Hesse','Germany','Frankfurt');
INSERT INTO cruiseport (CP_NAME, STATE, COUNTRY, CNAME) VALUES('Port of Mahahual','Mahahual', 'Maxico','Mahahual');
INSERT INTO cruiseport (CP_NAME, STATE, COUNTRY, CNAME) VALUES('Cochin cruise port','Kolkatta','India','Cochin');
INSERT INTO cruiseport (CP_NAME, STATE, COUNTRY, CNAME) VALUES('Mumbai cruiseport','Mumbai','India','Mumbai');
INSERT INTO cruiseport (CP_NAME, STATE, COUNTRY, CNAME) VALUES('Mangalore cruiseport','Mangalore','India','Mangalore');
INSERT INTO cruiseport (CP_NAME, STATE, COUNTRY, CNAME) VALUES('Mormugao cruiseport','Goa', 'India','Marmugao');


CREATE TABLE CRUISELINE
(CRUISELINEID VARCHAR(3) NOT NULL,
CL_NAME VARCHAR(50),
THREE_DIGIT_CODE VARCHAR(3),
PRIMARY KEY(CRUISELINEID));

SELECT *FROM CRUISELINE;

-- Insering values for Table: CRUISELINE --

INSERT INTO CRUISELINE (CRUISELINEID, CL_NAME, THREE_DIGIT_CODE) VALUES('AA','American CRUISELINEs','001');
INSERT INTO CRUISELINE (CRUISELINEID, CL_NAME, THREE_DIGIT_CODE) VALUES('AI','Carnival Cruise line ','098');
INSERT INTO CRUISELINE (CRUISELINEID, CL_NAME, THREE_DIGIT_CODE) VALUES('LH','Celebrity Cruises', '220');
INSERT INTO CRUISELINE (CRUISELINEID, CL_NAME, THREE_DIGIT_CODE) VALUES('BA','Disney Cruise Line','125');
INSERT INTO CRUISELINE (CRUISELINEID, CL_NAME, THREE_DIGIT_CODE) VALUES('QR','Azamara Cruiseline','157');
INSERT INTO CRUISELINE (CRUISELINEID, CL_NAME, THREE_DIGIT_CODE) VALUES('9W','Royal Caribbean International','589');
INSERT INTO CRUISELINE (CRUISELINEID, CL_NAME, THREE_DIGIT_CODE) VALUES('EK','Viking Ocean Cruises','176');
INSERT INTO CRUISELINE (CRUISELINEID, CL_NAME, THREE_DIGIT_CODE) VALUES('EY','Costa Cruises','607');
INSERT INTO CRUISELINE (CRUISELINEID, CL_NAME, THREE_DIGIT_CODE) VALUES('YK','MSC cruises','176');
INSERT INTO CRUISELINE (CRUISELINEID, CL_NAME, THREE_DIGIT_CODE) VALUES('MY','Princess Cruises','607');
INSERT INTO CRUISELINE (CRUISELINEID, CL_NAME, THREE_DIGIT_CODE) VALUES('GK','Robbin Cruises','307');



CREATE TABLE CONTAINS
(CRUISELINEID VARCHAR(3) NOT NULL,
CP_NAME VARCHAR(100) NOT NULL,
PRIMARY KEY(CRUISELINEID, CP_NAME),
FOREIGN KEY(CRUISELINEID) REFERENCES CRUISELINE(CRUISELINEID) ON DELETE CASCADE,
FOREIGN KEY(CP_NAME) REFERENCES cruiseport(CP_NAME) ON DELETE CASCADE);

-- Insering values into Table: Contains--

INSERT INTO CONTAINS (CRUISELINEID, CP_NAME) VALUES('AI','Port of Miami cruiseport');
INSERT INTO CONTAINS (CRUISELINEID, CP_NAME) VALUES('AI','Mumbai cruiseport');
INSERT INTO CONTAINS (CRUISELINEID, CP_NAME) VALUES('AI','Cochin cruise port');
INSERT INTO CONTAINS (CRUISELINEID, CP_NAME) VALUES('AI','Mormugao cruiseport');
INSERT INTO CONTAINS (CRUISELINEID, CP_NAME) VALUES('AI','Port of Texas and NEW Jersey');

INSERT INTO CONTAINS (CRUISELINEID, CP_NAME) VALUES('AA','Dallas/Fort Worth . cruiseport');
INSERT INTO CONTAINS (CRUISELINEID, CP_NAME) VALUES('AA','Port of Venice');
INSERT INTO CONTAINS (CRUISELINEID, CP_NAME) VALUES('AA','Port of Naha');
INSERT INTO CONTAINS (CRUISELINEID, CP_NAME) VALUES('AA','Port of Mahahual');
INSERT INTO CONTAINS (CRUISELINEID, CP_NAME) VALUES('AA','Mangalore cruiseport');


INSERT INTO CONTAINS (CRUISELINEID, CP_NAME) VALUES('BA','Port of Mahahual');
INSERT INTO CONTAINS (CRUISELINEID, CP_NAME) VALUES('BA','Port of Venice');
INSERT INTO CONTAINS (CRUISELINEID, CP_NAME) VALUES('Mumbai cruisepor');
INSERT INTO CONTAINS (CRUISELINEID, CP_NAME) VALUES('BA','Port of Mahahual');
INSERT INTO CONTAINS (CRUISELINEID, CP_NAME) VALUES('BA','Port of Texas and NEW Jersey');


INSERT INTO CONTAINS (CRUISELINEID, CP_NAME) VALUES('QR','Dallas/Fort Worth . cruiseport');
INSERT INTO CONTAINS (CRUISELINEID, CP_NAME) VALUES('QR','Port of Naha');
INSERT INTO CONTAINS (CRUISELINEID, CP_NAME) VALUES('QR','Cochin cruise port');
INSERT INTO CONTAINS (CRUISELINEID, CP_NAME) VALUES('QR','Mormugao cruiseport');
INSERT INTO CONTAINS (CRUISELINEID, CP_NAME) VALUES('QR','Port of Mahahual');





CREATE TABLE SHIP
(SHIP_CODE VARCHAR(10) NOT NULL,
SOURCE VARCHAR(3),
DESTINATION VARCHAR(3),
DEPARTURE VARCHAR(10),
STATUS VARCHAR(10),
DURATION VARCHAR(30),
SHIPTYPE VARCHAR(10),
CRUISELINEID VARCHAR(3),
PRIMARY KEY(SHIP_CODE),
FOREIGN KEY(CRUISELINEID) REFERENCES CRUISELINE(CRUISELINEID) ON DELETE CASCADE);


INSERT INTO SHIP(SHIP_CODE, SOURCE, DESTINATION,DEPARTURE, STATUS, DURATION, SHIPTYPE, CRUISELINEID)
VALUES('AI2014','BOM','DFW','03:15','On-time','24hr','Connecting','AI');


INSERT INTO SHIP(SHIP_CODE, SOURCE, DESTINATION, DEPARTURE, STATUS, DURATION, SHIPTYPE, CRUISELINEID)
VALUES('QR2305','BOM','DFW','13:55','Delayed','21hr','Non-stop','QR');


INSERT INTO SHIP(SHIP_CODE, SOURCE, DESTINATION,  DEPARTURE, STATUS, DURATION, SHIPTYPE, CRUISELINEID)
VALUES('EY1234','JFK','TPA','20:05','On-time','16hrs','Connecting','EY');


INSERT INTO SHIP(SHIP_CODE, SOURCE, DESTINATION, DEPARTURE, STATUS, DURATION, SHIPTYPE,  CRUISELINEID)
VALUES('LH9876','JFK','BOM','06:35','On-time','18hrs','Non-stop''LH');


INSERT INTO SHIP(SHIP_CODE, SOURCE, DESTINATION, DEPARTURE, STATUS, DURATION, SHIPTYPE,  CRUISELINEID)
VALUES('BA1689','FRA','DEL','10:55','On-time','14hrs','Non-stop''BA');


INSERT INTO SHIP(SHIP_CODE, SOURCE, DESTINATION,  DEPARTURE, STATUS, DURATION, SHIPTYPE,  CRUISELINEID)
VALUES('AA4367','SFO','FRA','18:55','On-time','21hrs','Non-stop','AA');


INSERT INTO SHIP(SHIP_CODE, SOURCE, DESTINATION,  DEPARTURE, STATUS, DURATION, SHIPTYPE,  CRUISELINEID)
VALUES('QR1902','IXC','IAH','22:50','Delayed','28hrs','Non-stop','QR');


INSERT INTO SHIP(SHIP_CODE, SOURCE, DESTINATION, DEPARTURE, STATUS, DURATION, SHIPTYPE,  CRUISELINEID)
VALUES('BA3056','BOM','DFW','02:55','On-time','29hrs','Connecting','BA');


INSERT INTO SHIP(SHIP_CODE, SOURCE, DESTINATION, DEPARTURE, STATUS, DURATION, SHIPTYPE,  CRUISELINEID)
VALUES('EK3456','BOM','SFO','19:40','On-time','30hrs','Non-stop','EK');


INSERT INTO SHIP(SHIP_CODE, SOURCE, DESTINATION, DEPARTURE, STATUS, DURATION, SHIPTYPE,  CRUISELINEID)
VALUES('YK3446','BOM','SFO','17:40','On-time','60hrs','Non-stop','YK');


INSERT INTO SHIP(SHIP_CODE, SOURCE, DESTINATION, DEPARTURE, STATUS, DURATION, SHIPTYPE,  CRUISELINEID)
VALUES('MK3476','BOM','SFO','14:40','On-time','80hrs','Non-stop','MY');


INSERT INTO SHIP(SHIP_CODE, SOURCE, DESTINATION, DEPARTURE, STATUS, DURATION, SHIPTYPE,  CRUISELINEID)
VALUES('9W4376','BOM','CFO','12:40','On-time','20hrs','Non-stop','9W');


INSERT INTO SHIP(SHIP_CODE, SOURCE, DESTINATION, DEPARTURE, STATUS, DURATION, SHIPTYPE,  CRUISELINEID)
VALUES('GK4376','BOM','CFO','12:40','On-time','20hrs','Non-stop','GK');







CREATE TABLE PASSENGER1
(PID INT NOT NULL,
PASSPORTNO VARCHAR(10) NOT NULL,
PRIMARY KEY(PID, PASSPORTNO));

-- Insering values in table: PASSENGER1--
-- Meditarenian Passport--

INSERT INTO PASSENGER1(PID, PASSPORTNO) VALUES(1,'A1234568');
INSERT INTO PASSENGER1(PID, PASSPORTNO) VALUES(2,'B9876541');
INSERT INTO PASSENGER1(PID, PASSPORTNO) VALUES(3,'C2345698');
INSERT INTO PASSENGER1(PID, PASSPORTNO) VALUES(4,'D1002004');
INSERT INTO PASSENGER1(PID, PASSPORTNO) VALUES(5,'X9324666');
INSERT INTO PASSENGER1(PID, PASSPORTNO) VALUES(6,'B8765430');
INSERT INTO PASSENGER1(PID, PASSPORTNO) VALUES(7,'J9801235');
INSERT INTO PASSENGER1(PID, PASSPORTNO) VALUES(8,'A1122334');
INSERT INTO PASSENGER1(PID, PASSPORTNO) VALUES(9,'Q1243567');
INSERT INTO PASSENGER1(PID, PASSPORTNO) VALUES(10,'S1243269');
INSERT INTO PASSENGER1(PID, PASSPORTNO) VALUES(11,'E3277889');
INSERT INTO PASSENGER1(PID, PASSPORTNO) VALUES(12,'K3212322');
INSERT INTO PASSENGER1(PID, PASSPORTNO) VALUES(13,'P3452390');
INSERT INTO PASSENGER1(PID, PASSPORTNO) VALUES(14,'W7543336');
INSERT INTO PASSENGER1(PID, PASSPORTNO) VALUES(15,'R8990566');

CREATE TABLE PASSENGER2
(PASSPORTNO VARCHAR(10) NOT NULL,
FNAME VARCHAR(20),
M VARCHAR(1),
LNAME VARCHAR(20),
ADDRESS VARCHAR(100),
AGE INT,
SEX VARCHAR(1),
PRIMARY KEY(PASSPORTNO));

--iNSERTING VALUES IN TABLE: PASSENGER2--
INSERT INTO PASSENGER2(PASSPORTNO,FNAME,M,LNAME,ADDRESS,AGE,SEX)
VALUES('A1234568','ALEN','M','SMITH','2230 NORTHSIDE, APT 11, ALBANY, NY',30,'M');

INSERT INTO PASSENGER2(PASSPORTNO,FNAME,M,LNAME,ADDRESS,AGE,SEX)
VALUES('B9876541','ANKITA','V','AHIR','3456 VIKAS APTS, APT 102,DOMBIVLI, INDIA',26,'F');

INSERT INTO PASSENGER2(PASSPORTNO,FNAME,M,LNAME,ADDRESS,AGE,SEX)
VALUES('C2345698','KHYATI','A','MISHRA','7820 MCCALLUM COURTS, APT 234, AKRON, OH',30,'F');

INSERT INTO PASSENGER2(PASSPORTNO,FNAME,M,LNAME,ADDRESS,AGE,SEX)
VALUES('D1002004','ANKITA','S','PATIL','7720 MCCALLUM BLVD, APT 1082, DALLAS, TX',23,'F');

INSERT INTO PASSENGER2(PASSPORTNO,FNAME,M,LNAME,ADDRESS,AGE,SEX)
VALUES('X9324666','TEJASHREE','B','PANDIT','9082 ESTAES OF RICHARDSON, RICHARDSON, TX',28,'F');

INSERT INTO PASSENGER2(PASSPORTNO,FNAME,M,LNAME,ADDRESS,AGE,SEX)
VALUES('B8765430','LAKSHMI','P','SHARMA','1110 FIR HILLS, APT 903, AKRON, OH',30,'F');

INSERT INTO PASSENGER2(PASSPORTNO,FNAME,M,LNAME,ADDRESS,AGE,SEX)
VALUES('J9801235','AKHILESH','D','JOSHI','345 CHATHAM COURTS, APT 678, MUMBAI, INDIA',29,'M');

INSERT INTO PASSENGER2(PASSPORTNO,FNAME,M,LNAME,ADDRESS,AGE,SEX)
VALUES('A1122334','MANAN','S','LAKHANI','5589 CHTHAM REFLECTIONS, APT 349 HOUSTON, TX',25,'F');

INSERT INTO PASSENGER2(PASSPORTNO,FNAME,M,LNAME,ADDRESS,AGE,SEX)
VALUES('Q1243567','KARAN','M','MOTANI','4444 FRANKFORD VILLA, APT 77, GUILDERLAND, NY',22,'M');

INSERT INTO PASSENGER2(PASSPORTNO,FNAME,M,LNAME,ADDRESS,AGE,SEX)
VALUES('S1243269','ROM','A','SOLANKI','7720 MCCALLUM BLVD, APT 2087, DALLAS, TX',60,'M');


INSERT INTO PASSENGER2(PASSPORTNO,FNAME,M,LNAME,ADDRESS,AGE,SEX)
VALUES('E3277889','John','A','GATES','1234 BAKER APTS, APT 59, HESSE, GERMANY',10,'M');

INSERT INTO PASSENGER2(PASSPORTNO,FNAME,M,LNAME,ADDRESS,AGE,SEX)
VALUES('K3212322','SARA','B','GOMES','6785 SPLITSVILLA, APT 34, MIAMI, FL',15,'F');

INSERT INTO PASSENGER2(PASSPORTNO,FNAME,M,LNAME,ADDRESS,AGE,SEX)
VALUES('P3452390','ALIA','V','BHAT','548 MARKET PLACE, SAN Francisco, CA',10,'F');

INSERT INTO PASSENGER2(PASSPORTNO,FNAME,M,LNAME,ADDRESS,AGE,SEX)
VALUES('W7543336','JOHN','P','SMITH','6666 ROCK HILL, APT 2902, TAMPA, FL',55,'M');

INSERT INTO PASSENGER2(PASSPORTNO,FNAME,M,LNAME,ADDRESS,AGE,SEX)
VALUES('R8990566','RIA','T','GUPTA','3355 PALENCIA, APT 2065, MUMBAI, INDIA',10,'M');


CREATE TABLE PASSENGER3
(PID INT NOT NULL,
SHIP_CODE VARCHAR(10),
PRIMARY KEY(PID),
FOREIGN KEY(SHIP_CODE) REFERENCES SHIP(SHIP_CODE) ON DELETE CASCADE);

-- INSERTING VALUES INTO TABLE: PASSENGER3--

INSERT INTO PASSENGER3(PID, SHIP_CODE) VALUES(1,'AI2014');
INSERT INTO PASSENGER3(PID, SHIP_CODE) VALUES(2,'LH9876');
INSERT INTO PASSENGER3(PID, SHIP_CODE) VALUES(3,'9W2334');
INSERT INTO PASSENGER3(PID, SHIP_CODE) VALUES(4,'QR1902');
INSERT INTO PASSENGER3(PID, SHIP_CODE) VALUES(5,'EY1234');
INSERT INTO PASSENGER3(PID, SHIP_CODE) VALUES(6,'BA3056');
INSERT INTO PASSENGER3(PID, SHIP_CODE) VALUES(7,'9W2334');
INSERT INTO PASSENGER3(PID, SHIP_CODE) VALUES(8,'AA4367');
INSERT INTO PASSENGER3(PID, SHIP_CODE) VALUES(9,'QR1902');
INSERT INTO PASSENGER3(PID, SHIP_CODE) VALUES(10,'EK3456');
INSERT INTO PASSENGER3(PID, SHIP_CODE) VALUES(11,'BA1689');
INSERT INTO PASSENGER3(PID, SHIP_CODE) VALUES(12,'QR1902');
INSERT INTO PASSENGER3(PID, SHIP_CODE) VALUES(13,'AI2014');
INSERT INTO PASSENGER3(PID, SHIP_CODE) VALUES(14,'BA1689');
INSERT INTO PASSENGER3(PID, SHIP_CODE) VALUES(15,'QR2305');


CREATE TABLE EMPLOYEE1
(SSN INT NOT NULL,
FNAME VARCHAR(20),
M VARCHAR(1),
LNAME VARCHAR(20),
ADDRESS VARCHAR(100),
AGE INT,
SEX VARCHAR(1),
JOBTYPE VARCHAR(30),
POSITION VARCHAR(30),
CP_NAME VARCHAR(100),
PRIMARY KEY(SSN),
FOREIGN KEY(CP_NAME) REFERENCES cruiseport(CP_NAME) ON DELETE CASCADE);


INSERT INTO EMPLOYEE1(SSN, FNAME, M, LNAME, ADDRESS, AGE, SEX, JOBTYPE,POSITION, CP_NAME)
VALUES(123456789,'LINDA','M','GOODMAN','731 Fondren, Houston, TX',35, 'F','ADMINISTRATIVE SUPPORT','RECEPTIONIST','Port of Miami cruiseport');

INSERT INTO EMPLOYEE1(SSN, FNAME, M, LNAME, ADDRESS, AGE, SEX, JOBTYPE,POSITION, CP_NAME)
VALUES(333445555,'JOHNY','N','PAUL','638 Voss, Houston, TX', 40, 'M','ADMINISTRATIVE SUPPORT','SECRETARY','Port of Texas and NEW Jersey');

INSERT INTO EMPLOYEE1(SSN, FNAME, M, LNAME, ADDRESS, AGE, SEX, JOBTYPE,POSITION, CP_NAME)
VALUES(999887777,'JAMES','P','BOND','3321 Castle, Spring, TX', 50, 'M','ENGINEER','RADIO ENGINEER','Port of Venice');


INSERT INTO EMPLOYEE1(SSN, FNAME, M, LNAME, ADDRESS, AGE, SEX, JOBTYPE,POSITION, CP_NAME)
VALUES(987654321,'SHERLOCK','A','HOLMES','123 TOP HILL, SAN Francisco,CA', 47, 'M','TRAFFIC MONITOR','SECRETARY','Port of Naha');

INSERT INTO EMPLOYEE1(SSN, FNAME, M, LNAME, ADDRESS, AGE, SEX, JOBTYPE,POSITION, CP_NAME)
VALUES(666884444,'SHELDON','A','COOPER','345 CHERRY PARK, HESSE,GERMANY', 55, 'M','CLEANER','WORKER','Port of Mahahual');


INSERT INTO EMPLOYEE1(SSN, FNAME, M, LNAME, ADDRESS, AGE, SEX, JOBTYPE,POSITION, CP_NAME)
VALUES(453453453,'RAJ','B','SHARMA','345 FLOYDS, MUMBAI,INDIA', 35, 'M','cruiseport AUTHORITY','MANAGER','Cochin cruise port');


INSERT INTO EMPLOYEE1(SSN, FNAME, M, LNAME, ADDRESS, AGE, SEX, JOBTYPE,POSITION, CP_NAME)
VALUES(987987987,'NIKITA','C','PAUL','110 SYNERGY PARK, DALLAS,TX', 33, 'F','ENGINEER','cruiseport CIVIL ENGINEER','Mumbai cruiseport');


INSERT INTO EMPLOYEE1(SSN, FNAME, M, LNAME, ADDRESS, AGE, SEX, JOBTYPE,POSITION, CP_NAME)
VALUES(888665555,'SHUBHAM','R','GUPTA','567 CHANDANI CHOWK, DELHI, INDIA', 39, 'M','ADMINISTRATIVE SUPPORT','DATA ENTRY WORKER','Mangalore cruiseport');

INSERT INTO EMPLOYEE1(SSN, FNAME, M, LNAME, ADDRESS, AGE, SEX, JOBTYPE,POSITION, CP_NAME)
VALUES(125478909,'PRATIK','T','GOMES','334 VITRUVIAN PARK, ALBANY, NY', 56, 'M','TRAFFIC MONITOR','','Mormugao cruiseport');  


INSERT INTO EMPLOYEE1(SSN, FNAME, M, LNAME, ADDRESS, AGE, SEX, JOBTYPE,POSITION, CP_NAME)
VALUES(987987102,'NIKHIL','C','PAWAR','CALIFORNIA WEST NORTH 582', 20, 'M','ENGINEER','cruiseport CIVIL ENGINEER','Dallas/Fort Worth . cruiseport');






CREATE TABLE EMPLOYEE2
(JOBTYPE VARCHAR(30) NOT NULL,
POSITION VARCHAR(30),
SALARY INT,
PRIMARY KEY(JOBTYPE));

--INSERTING VALUES INTO TABLE: EMPLOYEE2--
INSERT INTO EMPLOYEE2(JOBTYPE,POSITION, SALARY)VALUES('ADMINISTRATIVE SUPPORT','DATA ENTRY WORKER',50000);
INSERT INTO EMPLOYEE2(JOBTYPE,POSITION, SALARY)VALUES('ENGINEER','cruiseport CIVIL ENGINEER',70000);
INSERT INTO EMPLOYEE2(JOBTYPE,POSITION, SALARY)VALUES('TRAFFIC MONITOR','worker',80000);
INSERT INTO EMPLOYEE2(JOBTYPE,POSITION, SALARY)VALUES('cruiseport AUTHORITY','MANAGER',90000);

INSERT INTO EMPLOYEE2(JOBTYPE,POSITION, SALARY)VALUES('Computer Engineer','DATA ENTRY WORKER',100000);
INSERT INTO EMPLOYEE2(JOBTYPE,POSITION, SALARY)VALUES(' Civil ENGINEER','cruiseport CIVIL ENGINEER',120000);
INSERT INTO EMPLOYEE2(JOBTYPE,POSITION, SALARY)VALUES('Data Analysis','worker',170000);
INSERT INTO EMPLOYEE2(JOBTYPE,POSITION, SALARY)VALUES(' AUTHORITY','MANAGER',200000);




CREATE TABLE SERVES
(SSN INT NOT NULL,
PID INT NOT NULL,
PASSPORTNO VARCHAR(10) NOT NULL,
PRIMARY KEY(SSN, PID, PASSPORTNO),
FOREIGN KEY(SSN) REFERENCES EMPLOYEE1(SSN) ON DELETE CASCADE,
FOREIGN KEY(PID, PASSPORTNO) REFERENCES PASSENGER1(PID, PASSPORTNO) ON DELETE CASCADE);

-- INSERTING VALUES INTO TABLE: SERVES--
INSERT INTO SERVES(SSN, PID, PASSPORTNO) VALUES(123456789,1,'A1234568');
INSERT INTO SERVES(SSN, PID, PASSPORTNO) VALUES(123456789,15,'R8990566');
INSERT INTO SERVES(SSN, PID, PASSPORTNO) VALUES(123456789,9,'Q1243567');
INSERT INTO SERVES(SSN, PID, PASSPORTNO) VALUES(888665555,4,'D1002004');
INSERT INTO SERVES(SSN, PID, PASSPORTNO) VALUES(888665555,13,'P3452390');
INSERT INTO SERVES(SSN, PID, PASSPORTNO) VALUES(333445555,10,'S1243269');
INSERT INTO SERVES(SSN, PID, PASSPORTNO) VALUES(333445555,12,'K3212322');
INSERT INTO SERVES(SSN, PID, PASSPORTNO) VALUES(888665555,12,'K3212322');
INSERT INTO SERVES(SSN, PID, PASSPORTNO) VALUES(123456789,7,'J9801235');
INSERT INTO SERVES(SSN, PID, PASSPORTNO) VALUES(888665555,7,'J9801235');


CREATE TABLE TICKET1
(TICKET_NUMBER INT NOT NULL,
SOURCE VARCHAR(3),
DESTINATION VARCHAR(3),
DATE_OF_BOOKING DATE,
DATE_OF_TRAVEL DATE,
SEATNO VARCHAR(5),
CLASS VARCHAR(15),
PID INT,
PASSPORTNO VARCHAR(10),
FOREIGN KEY(PID, PASSPORTNO) REFERENCES PASSENGER1(PID, PASSPORTNO) ON DELETE CASCADE);

--INSERTING INTO TABLE: TICKET1--

INSERT INTO TICKET1(TICKET_NUMBER, SOURCE, DESTINATION, DATE_OF_BOOKING, DATE_OF_TRAVEL, SEATNO, CLASS, PID, PASSPORTNO)
VALUES(501,'BOM','DFW','11-MAY-16','15-DEC-16','32A','ECONOMY',1,'A1234568');

INSERT INTO TICKET1(TICKET_NUMBER, SOURCE, DESTINATION, DATE_OF_BOOKING, DATE_OF_TRAVEL, SEATNO, CLASS, PID, PASSPORTNO)
VALUES(502,'JFK','BOM','11-JUN-16','10-DEC-16','45D','ECONOMY',2,'B9876541');

INSERT INTO TICKET1(TICKET_NUMBER, SOURCE, DESTINATION, DATE_OF_BOOKING, DATE_OF_TRAVEL, SEATNO, CLASS, PID, PASSPORTNO)
VALUES(503,'IAH','DEL','21-AUG-16','25-DEC-16','1A','BUSINESS',3,'C2345698');

INSERT INTO TICKET1(TICKET_NUMBER, SOURCE, DESTINATION, DATE_OF_BOOKING, DATE_OF_TRAVEL, SEATNO, CLASS, PID, PASSPORTNO)
VALUES(504,'IXC','IAH','10-AUG-16','12-JAN-17','20C','FIRST-CLASS',4,'D1002004');

INSERT INTO TICKET1(TICKET_NUMBER, SOURCE, DESTINATION, DATE_OF_BOOKING, DATE_OF_TRAVEL, SEATNO, CLASS, PID, PASSPORTNO)
VALUES(505,'JFK','TPA','13-JUN-16','10-DEC-16','54E','ECONOMY',5,'X9324666');

INSERT INTO TICKET1(TICKET_NUMBER, SOURCE, DESTINATION, DATE_OF_BOOKING, DATE_OF_TRAVEL, SEATNO, CLASS, PID, PASSPORTNO)
VALUES(506,'BOM','DFW','11-NOV-16','12-FEB-17','43B','ECONOMY',6,'B8765430');

INSERT INTO TICKET1(TICKET_NUMBER, SOURCE, DESTINATION, DATE_OF_BOOKING, DATE_OF_TRAVEL, SEATNO, CLASS, PID, PASSPORTNO)
VALUES(507,'IAH','DEL','15-NOV-16','25-DEC-16','27B','FIRST-CLASS',7,'J9801235');

INSERT INTO TICKET1(TICKET_NUMBER, SOURCE, DESTINATION, DATE_OF_BOOKING, DATE_OF_TRAVEL, SEATNO, CLASS, PID, PASSPORTNO)
VALUES(508,'SFO','FRA','15-OCT-16','18-DEC-16','34E','ECONOMY',8,'A1122334');

INSERT INTO TICKET1(TICKET_NUMBER, SOURCE, DESTINATION, DATE_OF_BOOKING, DATE_OF_TRAVEL, SEATNO, CLASS, PID, PASSPORTNO)
VALUES(509,'IXC','IAH','12-NOV-16','30-DEC-16','54C','ECONOMY',9,'Q1243567');

INSERT INTO TICKET1(TICKET_NUMBER, SOURCE, DESTINATION, DATE_OF_BOOKING, DATE_OF_TRAVEL, SEATNO, CLASS, PID, PASSPORTNO)
VALUES(510,'BOM','SFO','22-JAN-16','15-DEC-16','38A','ECONOMY',10,'S1243269');



CREATE TABLE TICKET2
(DATE_OF_BOOKING DATE NOT NULL,
SOURCE VARCHAR(3) NOT NULL,
DESTINATION VARCHAR(3) NOT NULL,
CLASS VARCHAR(15) NOT NULL,
PRICE INT,
PRIMARY KEY(DATE_OF_BOOKING, SOURCE, DESTINATION, CLASS));

-- INSERTING VALUES INTO TICKET2--
INSERT INTO TICKET2(DATE_OF_BOOKING, SOURCE, DESTINATION, CLASS, PRICE) 
VALUES('11-MAY-16','BOM','DFW','ECONOMY',95000);

INSERT INTO TICKET2(DATE_OF_BOOKING, SOURCE, DESTINATION, CLASS, PRICE) 
VALUES('11-JUN-16','JFK','BOM','ECONOMY',100000);

INSERT INTO TICKET2(DATE_OF_BOOKING, SOURCE, DESTINATION, CLASS, PRICE) 
VALUES('21-AUG-16','IAH','DEL','BUSINESS',200000);

INSERT INTO TICKET2(DATE_OF_BOOKING, SOURCE, DESTINATION, CLASS, PRICE) 
VALUES('10-AUG-16','IXC','IAH','FIRST-CLASS',150000);

INSERT INTO TICKET2(DATE_OF_BOOKING, SOURCE, DESTINATION, CLASS, PRICE) 
VALUES('13-JUN-16','JFK','TPA','ECONOMY',98000);

INSERT INTO TICKET2(DATE_OF_BOOKING, SOURCE, DESTINATION, CLASS, PRICE) 
VALUES('11-NOV-16','BOM','DFW','ECONOMY',125000);

INSERT INTO TICKET2(DATE_OF_BOOKING, SOURCE, DESTINATION, CLASS, PRICE) 
VALUES('15-NOV-16','IAH','DEL','FIRST-CLASS',195000);

INSERT INTO TICKET2(DATE_OF_BOOKING, SOURCE, DESTINATION, CLASS, PRICE) 
VALUES('15-OCT-16','SFO','FRA','ECONOMY',170000);

INSERT INTO TICKET2(DATE_OF_BOOKING, SOURCE, DESTINATION, CLASS, PRICE) 
VALUES('12-NOV-16','IXC','IAH','ECONOMY',140000);

INSERT INTO TICKET2(DATE_OF_BOOKING, SOURCE, DESTINATION, CLASS, PRICE) 
VALUES('22-JAN-16','BOM','SFO','ECONOMY',45000);

INSERT INTO TICKET2(DATE_OF_BOOKING, SOURCE, DESTINATION, CLASS, PRICE) 
VALUES('19-OCT-16','FRA','DEL','ECONOMY',100000);

INSERT INTO TICKET2(DATE_OF_BOOKING, SOURCE, DESTINATION, CLASS, PRICE) 
VALUES('20-NOV-16','IXC','IAH','ECONOMY',120000);



CREATE TABLE TICKET3
(DATE_OF_CANCELLATION DATE NOT NULL,
SURCHARGE INT,
PRIMARY KEY(DATE_OF_CANCELLATION));

SELECT *FROM TICKET3;


-- INSERTING VALUES INTO TABLE: TICKET3--

INSERT INTO TICKET3(DATE_OF_CANCELLATION, SURCHARGE) VALUES('10-DEC-16',75000);
INSERT INTO TICKET3(DATE_OF_CANCELLATION, SURCHARGE) VALUES('25-MAY-16',25000);



-- Trigger, when SHIP is delayed it is logged into different table--

 CREATE TABLE DELAYED_SHIPS 
 ("SHIP_CODE" VARCHAR(20 ), 
 "SOURCE" VARCHAR(20 ),
 "DESTINATION" VARCHAR(20), 
 "CRUISELINEID" VARCHAR(20));
 
 -- CREATE FUNCTION--
 CREATE OR REPLACE FUNCTION delay() RETURNS TRIGGER AS $example_table$
 BEGIN
 if NEW.STATUS='Delayed'
 then
  INSERT INTO DELAYED_SHIPS(SHIP_CODE, SOURCE, DESTINATION , CRUISELINEID)
  values(NEW.SHIP_CODE,NEW.SOURCE,NEW.DESTINATION,NEW.CRUISELINEID);
  END IF;
  RETURN NEW;
END;
$example_table$ LANGUAGE plpgsql;


CREATE TRIGGER DELAYEDSHIPS
AFTER INSERT ON SHIP
FOR EACH ROW EXECUTE PROCEDURE delay();


INSERT INTO SHIP(SHIP_CODE, SOURCE, DESTINATION, DEPARTURE, STATUS, DURATION, SHIPTYPE,  CRUISELINEID)
VALUES('MK3444','BOM','SFO','14:40','Delayed','80hrs','Non-stop','MY');



-- TRIGGER TO UPDATE 'TICKET_PRICE_HISTORY' TABLE WHEN THE PRICE OF AN AIR TICKET IS UPDATED IN TICKET2 TABLE--

-- CREATING TABLE TICKET_PRICE_HISTORY--

-- create table--
CREATE TABLE TICKET_PRICEHISTORY
(DATE_OF_BOOKING DATE NOT NULL,
SOURCE VARCHAR(3) NOT NULL,
DESTINATION VARCHAR(3) NOT NULL,
CLASS VARCHAR(15) NOT NULL,
PRICE BIGINT,
PRIMARY KEY(DATE_OF_BOOKING, SOURCE, DESTINATION, CLASS));

CREATE OR REPLACE FUNCTION history() RETURNS TRIGGER AS $example_table$
BEGIN
INSERT INTO TICKET_PRICEHISTORY
VALUES(OLD.DATE_OF_BOOKING,OLD.SOURCE, OLD.DESTINATION, OLD.CLASS, OLD.PRICE);
RETURN NEW;
END;
$example_table$ LANGUAGE plpgsql;

 -- create trigger--
CREATE TRIGGER ticket
BEFORE UPDATE OF PRICE ON TICKET2
FOR EACH ROW EXECUTE PROCEDURE history();

--update--
UPDATE TICKET2 SET PRICE=300000
WHERE DATE_OF_BOOKING='21-AUG-16'
AND SOURCE='IAH'
AND DESTINATION='DEL' AND CLASS='BUSINESS';


UPDATE TICKET2 SET PRICE=250000
WHERE DATE_OF_BOOKING='11-JUN-16'
AND SOURCE='JFK'
AND DESTINATION='BOM' AND CLASS='ECONOMY';


-- Trigger, when SHIP is delayed it is logged into different table--

CREATE TABLE DELAYED_SHIPS
(SHIP_CODE VARCHAR(20),DESTINATION VARCHAR(20),SOURCE VARCHAR(20),CRUISELINEID VARCHAR(20));

CREATE OR REPLACE FUNCTION delay() RETURNS TRIGGER AS $example_table$
BEGIN
if NEW.STATUS='Delayed'
then
INSERT INTO DELAYED_SHIPS(SHIP_CODE,SOURCE,DESTINATION,CRUISELINEID)
VALUES(NEW.SHIP_CODE,NEW.SOURCE,NEW.DESTINATION,NEW.CRUISELINEID);
END IF;
RETURN NEW;
END;
$example_table$ LANGUAGE plpgsql;

CREATE TRIGGER DELAYEDSHIPS
AFTER INSERT ON SHIP
FOR EACH ROW EXECUTE PROCEDURE delay();

INSERT INTO SHIP(SHIP_CODE, SOURCE, DESTINATION,DEPARTURE,STATUS, DURATION, SHIPTYPE, CRUISELINEID)
VALUES('AI2555','BOM','DFW','03:15','Delayed','24hr','Connecting','AI');



--SQL Quiries--

--1) Selecting all Cruise ports of India
	SELECT CP_NAME FROM CRUISEPORT WHERE COUNTRY='India'
--2) Selecting SHIPCODE from table SHIP where source is ´BOM´
	SELECT SHIP_CODE FROM SHIP WHERE SOURCE='BOM';
--3) List of the Passengers their AGE is >=30
	SELECT FNAME FROM PASSENGER2 WHERE AGE>=30; 

SELECT JOBTYPE FROM EMPLOYEE2 WHERE SALARY>10000;

--b) COMPLEX QUERIES:
--1) Retrieve the names of all employees who have the same jobtype as Employee ´NIKITA´.

SELECT DISTINCT FNAME,M,LNAME
FROM 
EMPLOYEE1
WHERE JOBTYPE IN
(SELECT JOBTYPE FROM EMPLOYEE1 WHERE FNAME='NIKITA');


--2) Retrieve the names of all passengers who have booked their tickets in ECONOMY CLASS.
 
SELECT DISTINCT P.FNAME,P.LNAME,T.CLASS
FROM
PASSENGER2 AS P,TICKET1 AS T
WHERE
P.PASSPORTNO IN
(SELECT T.PASSPORTNO FROM TICKET1 WHERE T.CLASS='ECONOMY' AND T.PASSPORTNO=P.PASSPORTNO);


--c) AGGREGATE FUNCTIONS:
--1) Retrieve job type and number of employees in each job type where each job type has more than 1 employee 

SELECT COUNT(*)
FROM PASSENGER2 AS P,TICKET1 AS T
WHERE P.PASSPORTNO=T.PASSPORTNO AND T.CLASS='BUSINESS';


--2)Retrieve number of passengers who have booked their tickets in Business class 

SELECT JOBTYPE,COUNT(*)
FROM EMPLOYEE1
GROUP BY JOBTYPE
HAVING COUNT(*)>1;


SELECT SUM(SALARY),MAX(SALARY),MIN(SALARY),AVG(SALARY)
 FROM EMPLOYEE2;
 


--Check constraints--

ALTER TABLE EMPLOYEE1
ADD CONSTRAINT AGE_LIMIT CHECK(AGE<67);


ALTER TABLE TICKET1
ADD CONSTRAINT TICKET_NO_LENGTH CHECK(LENGTH(CAST(TICKET_NUMBER AS TEXT))<=13);





